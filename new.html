<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ayurvedic Symptom Checker</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 20px; }
        .container { max-width: 700px; margin: auto; background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { margin-top: 0; color: #2a4d69; }
        textarea { width: 100%; padding: 10px; border: 1px solid #bbb; border-radius: 6px; font-size: 15px; resize: vertical; }
        button { margin-top: 20px; padding: 12px 20px; background: #2a4d69; color: white; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; }
        button:hover { background: #1e364d; }
        #result { margin-top: 20px; }
        .warn-box { background: #ffdddd; padding: 15px; border-radius: 6px; border-left: 5px solid #ff4b4b; }
        .result-bg { background: #e7f3ff; padding: 15px; border-radius: 8px; }
        .treat-box { border: 1px dashed #999; background: white; padding: 12px; margin-bottom: 10px; border-radius: 8px; }
    </style>
</head>
<body>

    <script>
        // Database
        const TREATMENT_DB = [
  {
    symptoms: ["cold", "running nose", "blocked nose", "nasal congestion"],
    name: "Shunthi (Dry ginger) & Honey decoction",
    details:
      "Mix dry ginger powder with honey in warm water. Do steam inhalation with tulsi/ginger.",
    precautions: "Avoid cold drinks. Consult doctor if breathing difficulty."
  },
  {
    symptoms: ["fever", "high temperature"],
    name: "Tulsi + Giloy decoction",
    details:
      "Boil tulsi leaves and giloy; sip warm. Stay hydrated.",
    precautions: "If fever is > 2 days, see doctor."
  },
  {
    symptoms: ["headache", "migraine"],
    name: "Brahmi/Tulsi tea & Oil massage",
    details:
      "Apply warm sesame oil on forehead and rest. Brahmi tea helps.",
    precautions: "Sudden severe headache — seek medical care."
  },
  {
    symptoms: ["stomach pain", "indigestion", "gas"],
    name: "Ajwain + Hing + Warm water",
    details:
      "Take ajwain in warm water or hing with warm ghee.",
    precautions: "Severe pain with vomiting — visit doctor."
  },
  {
    symptoms: ["cough", "dry cough"],
    name: "Tulsi-ginger-honey decoction",
    details:
      "Boil tulsi + ginger; add honey. Steam inhalation recommended.",
    precautions: "If long-term cough, consult doctor."
  },
  {
    symptoms: ["ear pain", "blocked ear"],
    name: "Warm oil drops (sesame oil)",
    details:
      "Use slightly warm til oil drops. Do NOT use if ear discharge.",
    precautions: "If severe or with discharge — ENT check."
  }
];

// ------ Utility ------
function normalize(s) {
  return (s || "").toLowerCase().trim();
}

  // Match input symptoms with DB
  function matchTreatments(inputSymptoms) {
  const results = [];
  for (const entry of TREATMENT_DB) {
    const keyWords = entry.symptoms.map(normalize);
    let score = 0;
    for (const us of inputSymptoms) {
      for (const kw of keyWords) {
        if (us.includes(kw) || kw.includes(us)) score++;
      }
    }
    if (score > 0) results.push({ entry, score });
  }
  results.sort((a, b) => b.score - a.score);
  return results.map(r => r.entry);
}

// ------ UI Creator ------
function createUI() {
  // If a user registered, show a small banner with their name and an option to clear
  const registeredRaw = localStorage.getItem('userData');
  if (registeredRaw) {
    try {
      const registered = JSON.parse(registeredRaw);
      const banner = document.createElement('div');
      banner.style.maxWidth = '700px';
      banner.style.margin = '12px auto';
      banner.style.padding = '10px 14px';
      banner.style.borderRadius = '8px';
      banner.style.background = '#e6ffef';
      banner.style.color = '#065f46';
      banner.style.display = 'flex';
      banner.style.justifyContent = 'space-between';
      banner.style.alignItems = 'center';
      const name = registered.name ? registered.name : 'Guest';
      banner.innerHTML = `<div>Welcome back, <strong>${escapeHtml(name)}</strong> — registration saved.</div>`;
      const clearBtn = document.createElement('button');
      clearBtn.innerText = 'Clear registration';
      clearBtn.style.marginLeft = '12px';
      clearBtn.style.padding = '8px 10px';
      clearBtn.style.border = 'none';
      clearBtn.style.borderRadius = '6px';
      clearBtn.style.background = '#d9534f';
      clearBtn.style.color = '#fff';
      clearBtn.style.cursor = 'pointer';
      clearBtn.onclick = () => {
        localStorage.removeItem('userData');
        banner.remove();
        alert('Registration cleared.');
      };
      banner.appendChild(clearBtn);
      document.body.appendChild(banner);
    } catch (e) {
      // ignore parse errors
      console.warn('Could not parse stored userData', e);
    }
  }
  const container = document.createElement("div");
  container.style.maxWidth = "700px";
  container.style.margin = "20px auto";
  container.style.padding = "25px";
  container.style.border = "1px solid #ddd";
  container.style.borderRadius = "10px";
  container.style.fontFamily = "Arial";

  const h = document.createElement("h2");
  h.innerText = "Ayurvedic Symptom → Treatment Checker";
  container.appendChild(h);

  const p = document.createElement("p");
  p.innerText = "Enter symptoms";
  container.appendChild(p);

  const ta = document.createElement("textarea");
  ta.rows = 4;
  ta.style.width = "100%";
  
  container.appendChild(ta);

  const btn = document.createElement("button");
  btn.innerText = "Get Treatment";
  btn.style.marginTop = "12px";
  btn.onclick = () => {
    const raw = ta.value.trim();
    if (!raw) {
      show("Please enter symptoms.", true);
      return;
    }
    const parts = raw.split(/[\n,]+/).map(normalize).filter(Boolean);
    const matches = matchTreatments(parts);
    if (matches.length === 0) {
      show("No treatment found. Try different words.", true);
      return;
    }
    let html = "";
    matches.forEach((m, i) => {
      html += `
      <div style="border:1px dashed #aaa;padding:10px;margin:8px;border-radius:6px">
        <strong>${i + 1}. ${m.name}</strong>
        <p>${m.details}</p>
        <small style="color:#555"><b>Precautions:</b> ${m.precautions}</small>
      </div>`;
    });
    show(html, false);
  };
  container.appendChild(btn);

  const res = document.createElement("div");
  res.id = "result";
  res.style.marginTop = "12px";
  container.appendChild(res);

  function show(html, warn) {
    res.innerHTML = "";
    const box = document.createElement("div");
    box.style.padding = "10px";
    box.style.borderRadius = "6px";
    box.style.background = warn ? "#ffdddd" : "#e7f3ff";
    box.innerHTML = html;
    res.appendChild(box);
  }

  document.body.appendChild(container);
}

// small helper to avoid injecting raw HTML from storage
function escapeHtml(str) {
  return String(str)
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#039;');
}

// Load UI
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", createUI);
} else {
  createUI();
}
    </script>

</body>
</html>